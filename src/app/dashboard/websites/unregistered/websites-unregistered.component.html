<app-banner title="Suivi des sites internet"></app-banner>

<app-page animated="false">
  <div class="container position-relative bg-white">
    <nav class="nav nav-tabs nav-justified" role="tablist" aria-label="Type de site internet">
      <button class="nav-item nav-link" [routerLink]="['/moderation-url-entreprises']" *appRole="[roles.Admin]"
              role="tab"
              tabIndex="0">
        Associations sites / entreprises
      </button>
      <button class="nav-item nav-link active" [routerLink]="['/sites-internet','non-identifies']"
              role="tab" attr.aria-selected="true" attr.aria-controls="panel1" id="tab1"
              tabIndex="1">
        Sites non identifiés
      </button>
    </nav>
  </div>
  <app-panel [loading]="websiteService.fetchingUnregistered">
    <app-panel-header>
      <input [(ngModel)]="hostFilter" class="form-control form-control-material host-form-control" placeholder="Nom du site" (keydown.enter)="fetchUnregisteredWebsites()"/>
      <input
        class="form-control form-control-material"
        [(bsValue)]="periodFilter"
        bsDaterangepicker
        autocomplete="off"
        placeholder="Période sélectionnée"
        [bsConfig]="{ containerClass: 'theme-default', rangeInputFormat: 'DD MMMM YYYY' }"
        triggers="click keypress"
        (bsValueChange)="fetchUnregisteredWebsites()"
      />
      <button mat-icon-button (click)="extract()" matTooltip="Exporter en XLS">
        <mat-icon>get_app</mat-icon>
      </button>
      <button mat-icon-button matTooltip="Supprimer tous les filtres" (click)="clearFilters()">
        <mat-icon>clear</mat-icon>
      </button>
    </app-panel-header>
    <table mat-table [dataSource]="dataSource" matSort class="fullwidth" matSortActive="count" matSortDirection="desc">


      <ng-container matColumnDef="count">
        <th mat-sort-header mat-header-cell *matHeaderCellDef>Nombre de signalements</th>
        <td class="td-count text-center" mat-cell *matCellDef="let _">
          {{_.count}}
        </td>
      </ng-container>

      <ng-container matColumnDef="host">
        <th mat-sort-header mat-header-cell *matHeaderCellDef>Nom du site</th>
        <td mat-cell *matCellDef="let _">
          {{_.host}}
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="columns"></tr>
      <tr mat-row *matRowDef="let row; columns: columns;"></tr>
    </table>
    <mat-paginator [pageSizeOptions]="[5, 10, 25, 100]" pageSize="25"></mat-paginator>
  </app-panel>

  <div class="notification error" *ngIf="websiteService.fetchUnregisteredError">
    Une erreur technique s'est produite
  </div>
</app-page>
