<app-banner title="Statistiques"></app-banner>

<app-page pageDefinitionKey="stats" size="small">
  <app-panel>
    <app-panel-body>
      <h2 *ngIf="reportCount">
        <span class="count">{{reportCount}}</span>
        signalements ont été déposés depuis le début de SignalConso
      </h2>
      <div class="text-right">
        <a (click)="loadMonthlyReportChart()" data-toggle="collapse" href="#collapseMonthlyReportChart"
           class="collapsed">
          Consulter les statistiques mensuelles
        </a>
      </div>
      <div class="collapse" id="collapseMonthlyReportChart">
        <div echarts [options]="monthlyReportChart" *ngIf="renderCharts()"></div>
        <ngx-loading [show]="!monthlyReportChart"></ngx-loading>
      </div>
      <ngx-loading [show]="!reportCount"></ngx-loading>
    </app-panel-body>
  </app-panel>
  <app-panel>
    <app-panel-body>
      <h2 *ngIf="reportForwardedToProPercentage">
        <span class="count">{{reportForwardedToProPercentage.toFixed(0) + "%"}}</span>
        des signalements ont été transmis à l'entreprise signalée
        <i class="material-icons help" aria-hidden="true"
           tooltip="Pourquoi pas 100 % ? Car dans certaines cas (achat en ligne...) les entreprises n'ont pas pu être identifiées par le consommateur">
          help_outline
        </i>
      </h2>
      <div class="text-right">
        <a (click)="loadMonthlyReportForwardedToProChart()" data-toggle="collapse"
           href="#collapseMonthlyReportForwardedToProChart" class="collapsed">
          Consulter les statistiques mensuelles
        </a>
      </div>
      <div class="collapse" id="collapseMonthlyReportForwardedToProChart">
        <div echarts [options]="monthlyReportForwardedToProChart" *ngIf="renderCharts()"></div>
        <ngx-loading [show]="!monthlyReportForwardedToProChart"></ngx-loading>
      </div>
      <ngx-loading [show]="!reportForwardedToProPercentage"></ngx-loading>
    </app-panel-body>
  </app-panel>
  <app-panel>
    <app-panel-body>
      <h2 *ngIf="reportReadByProPercentage">
        <span class="count">{{reportReadByProPercentage.toFixed(0) + "%"}}</span>
        des signalements transmis ont été lus par les entreprises
        <i class="material-icons help" aria-hidden="true"
           tooltip="Pourquoi pas 100 % ? Car Signalconso est facultatif. L'entreprise est libre de créer un compte et de lire le signalement.">
          help_outline
        </i>
      </h2>
      <div class="text-right">
        <a (click)="loadMonthlyReportReadByProChart()" data-toggle="collapse"
           href="#collapseMonthlyReportReadByProChart" class="collapsed">
          Consulter les statistiques mensuelles
        </a>
      </div>
      <div class="collapse" id="collapseMonthlyReportReadByProChart">
        <div echarts [options]="monthlyReportReadByProChart" *ngIf="renderCharts()"></div>
        <ngx-loading [show]="!monthlyReportReadByProChart"></ngx-loading>
      </div>
      <ngx-loading [show]="!reportReadByProPercentage"></ngx-loading>
    </app-panel-body>
  </app-panel>
  <app-panel>
    <app-panel-body>
      <h2 *ngIf="reportWithResponsePercentage !== undefined">
        Sur l'ensemble des signalements lus,
        <span class="count">{{reportWithResponsePercentage.toFixed(0) + "%"}}</span>
        ont eu une réponse de l'entreprise
        <i class="material-icons help" aria-hidden="true"
           tooltip="Lorsqu'une entreprise reçoit un signalement, elle peut décider de répondre ou non au consommateur.">
          help_outline
        </i>
      </h2>
      <div class="text-right">
        <a (click)="loadMonthlyReportWithReponseChart()" data-toggle="collapse"
           href="#collapseMonthlyReportWithResponseChart" class="collapsed">
          Consulter les statistiques mensuelles
        </a>
      </div>
      <div class="collapse" id="collapseMonthlyReportWithResponseChart">
        <div echarts [options]="monthlyReportWithResponseChart" *ngIf="renderCharts()"></div>
        <ngx-loading [show]="!monthlyReportWithResponseChart"></ngx-loading>
      </div>
      <ngx-loading [show]="reportWithResponsePercentage === undefined"></ngx-loading>
    </app-panel-body>
  </app-panel>
  <app-panel>
    <app-panel-body>
      <h2 *ngIf="reportWithWebsitePercentage">
        <span class="count">{{reportWithWebsitePercentage.toFixed(0) + "%"}}</span>
        des signalements déposés depuis le début de SignalConso concernent une entreprise sur internet
      </h2>
      <ngx-loading [show]="!reportWithWebsitePercentage"></ngx-loading>
    </app-panel-body>
  </app-panel>
  <p class="note pt-2">
    Nos statistiques sont mises à jour en temps réel
  </p>
</app-page>
